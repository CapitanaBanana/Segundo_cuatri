a-
DATO EQU  40H
ESTADO EQU 41H


ORG 1000H
CADENA DB "HOLIS"
FIN DB 0
ORG 2000H

MOV BX, OFFSET CADENA
;CONFIG HANDSHAKE
IN AL, ESTADO
OR AL, 0H
OUT ESTADO,AL


LOOPEAR: MOV AL, [BX]
 OUT DATO, AL
 INC BX
 CMP BX, OFFSET FIN
 JNZ LOOPEAR
INT 0
END
------------------------------
c- 
DATO EQU  40H
ESTADO EQU 41H
EOI EQU 20H
IMR EQU 21H
INT2 EQU 26H

ORG 20
IP_INT2 DW IMPRIMIR
ORG 1000H
CADENA DB "UNI"
FIN DB 0

ORG 3000H
IMPRIMIR: MOV AL,[BX]
OUT DATO,AL
INC BX
CMP BX, OFFSET FIN
JNZ IMPRIMIR
MOV AL,0FFH; EL DE IN ESTADO Y APLICARLE AND NO FUNCIONA COMENTAAAR
OUT IMR, AL
MOV AL, 20H
OUT EOI, AL
IRET
ORG 2000H
;CONFIG PIC
CLI
MOV AL, 11111011B; activamos la int de handshake
OUT IMR, AL

MOV AL,5
OUT INT2, AL;direc de la interrupcion 

STI
MOV BX, OFFSET CADENA

IN AL, ESTADO
OR AL, 80H
OUT ESTADO,AL

LOOPEAR: CMP BX, OFFSET FIN
JNZ LOOPEAR


INT 0
END
--------------------------
d-
DATO EQU 40H
ESTADO EQU 41H

ORG 1000H
CAR DB ?
ORG 3000H
 
POLLING: IN AL,ESTADO
AND AL,1
JNZ POLLING
CMP CL,0
JZ SEGU

MOV AL,[BX]
OUT DATO, AL
INC BX
DEC CL
JNZ POLLING

SEGU: DEC BX
MOV AL,[BX] 
OUT DATO, AL
DEC CH
JNZ POLLING
RET

ORG 2000H
IN AL,ESTADO; DESACTIVAMOS INTS DE HANDSHAKE
AND AL, 7FH
OUT ESTADO,AL
MOV CL,2
MOV BX, OFFSET CAR
L: INT 6
INC BX
DEC CL
JNZ L

MOV BX, OFFSET CAR
MOV CL,2
MOV CH, 2

CALL POLLING
INT 0
END

----------------------------------------
e-
DATO EQU 40H
ESTADO EQU 41H
EOI EQU 20H
IMR EQU 21H
INT2 EQU 26H

ORG 40
ID_INT2 DW IMPRIMIR

ORG 1000H
CADENA DB "INGRESE LOS CARACTERES A IMPRIMIR"
FIN DB ?
ADELANTE DB 00H
CAR DB ?
ORG 1026H
ATRAS DB 00H

ORG 3000H
IMPRIMIR:MOV AL, [BX]
OUT DATO, AL
CMP DL, 0
JNZ DECREMENTAR
ADD BX, 2
DECREMENTAR: DEC BX
CMP BYTE PTR [BX], 00H
JNZ FINN

MOV AL, 11111111B;DESACTIVO INTERRUPCIONES PARA SALIR
OUT IMR, AL

FINN: MOV AL, 20H
OUT EOI, AL
IRET


ORG 2000H
MOV BX, OFFSET CADENA
MOV AL, OFFSET FIN- OFFSET CADENA
INT 7

MOV CX, 3
MOV BX, OFFSET CAR
PEDIR: INT 6
INC BX
DEC CX
JNZ PEDIR
;CONFIG DEL PIC
CLI
MOV AL, 11111011B
OUT IMR, AL

MOV AL, 10
OUT INT2, AL

STI
MOV BX, OFFSET CAR
MOV DL, 0;VOY A USAR DL COMO FLAG PARA SABER CUANDO ESTOY EN LA SEGUNDA VUELTA
IN AL,ESTADO
OR AL, 10000000B
OUT ESTADO, AL

LOOPEAR: CMP BYTE PTR [BX], 00
JNZ LOOPEAR

MOV DL,1
CLI
MOV AL, 11111011B
OUT IMR, AL
STI
LOOPEAR2: CMP BYTE PTR [BX], 00
JNZ LOOPEAR2

INT 0
END
