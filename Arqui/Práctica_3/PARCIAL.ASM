DATO EQU 40H
ESTADO EQU 41H
EOI EQU 20H
IMR EQU 21H
INT2 EQU 26H

ORG 44
IP_INT2 DW IMPRIMIR

ORG 1000H
CADENA DB "KSAHKJDZ,X..-Ñz[ñx[Z[23KJjskahsdjagsxyyzg2"
FIN DB ?
PARES DB ?
ORG 3000H
SELECCIONADO: MOV CH, [BX]
AND CH, 00000001B
JZ PAR
MOV AL, 0
JMP FIN1
PAR: MOV AL, 1
FIN1:RET


ORG 3500H
IMPRIMIR: MOV AL, [BX]
OUT DATO, AL
INC BX
DEC CL
JZ TERMINAR
CLI
MOV AL, 0FFH
OUT IMR, AL
STI
TERMINAR: MOV AL, 20H
OUT EOI, AL
IRET

ORG 2000H
MOV BX, OFFSET CADENA-1
MOV CL, 0
LOOPEAR: CMP BX, OFFSET FIN
JZ SEGUIR
INC BX
CALL SELECCIONADO
CMP AL, 0
JZ LOOPEAR
MOV DL, [BX]
MOV OFFSET PARES + CL, DL
INC CL
CMP BX, OFFSET FIN
JNZ LOOPEAR
SEGUIR: MOV BX, OFFSET PARES
IN AL, ESTADO
OR AL, 10000000B
OUT ESTADO, AL
CLI
MOV AL, 11111011B
OUT IMR, AL
MOV AL, 11
OUT INT2, AL
STI
REPETIR: CMP CL, 0
INT 0
END
